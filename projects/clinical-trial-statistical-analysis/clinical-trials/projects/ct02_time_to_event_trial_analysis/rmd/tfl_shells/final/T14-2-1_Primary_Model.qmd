---
title: "T14-2-1 Primary Efficacy Model (Cox Proportional Hazards)"
format: html
execute:
  echo: false
  warning: false
  message: false
---

```{r}
source("rmd/tfl_shells/final/00_tfl_setup.R")

model_rds <- file.path(TFL$results, "primary_model.rds")
tfl_assert_files(model_rds)

m <- readRDS(model_rds)

b <- coef(m)["trtActive"]
V <- vcov(m)["trtActive","trtActive"]
se <- sqrt(V)

hr <- exp(b)
ci <- exp(b + c(-1,1)*1.96*se)

z <- b / se
p <- 2*pnorm(abs(z), lower.tail = FALSE)

html_path <- file.path(TFL$tables, "primary_model.html")

if (file.exists(html_path)) {
  htmltools::includeHTML(html_path)
} else {
  gtsummary::tbl_regression(m, exponentiate = TRUE)
}
```
